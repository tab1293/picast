<html>
<head>
    <title>Picast</title>
    <link rel="stylesheet" type="text/css" href="../css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="../css/index.css">
    <script type="text/javascript" src="../js/jquery-1.11.3.min.js"></script>
    <script type="text/javascript" src="../js/jquery-fix.js"></script>
    <script type="text/javascript" src="../js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../js/handlebars-v3.0.3.js"></script>
    <script id="movieInfoTemplate" type="text/x-handlebars-template">
        <div id="container">
            <div class="row">
                <div class="col-lg-2">
                </div>
                <div class="col-lg-3">
                    <img class="poster" {{#if Poster}} src="{{Poster}}" {{else}} src="./img/no-poster.jpg" {{/if}}></img>
                </div>
                <div class="col-lg-5">
                    <div class="info">
                         <div> <span class="title">{{Title}}</span> &nbsp;&nbsp; Released: {{Released}} &nbsp; - &nbsp; Rated {{Rated}} &nbsp; - &nbsp; Runtime: {{Runtime}} &nbsp;</div>
                        <div class="plot">{{Genre}}</div>
                        <br/>
                        <div class="plot"><strong>Synopsis:</strong>
                        <div class="plot">{{Plot}}</div>
                        <br/>
                        <div class="actors"><strong>Actors:</strong></div>
                        <div class="actors">{{Actors}} </div>
                        <br/>
                        <div class="actors"><strong>Director:</strong></div>
                        <div class="actors">{{Director}} </div>
                        <br/>
                        <div class="actors"><strong>Written By:</strong></div>
                        <div class="actors">{{Writer}} </div>
                    </div>
                </div>
                <div class="col-lg-2">
                </div>
            </div>
        </div>
        <div class="row">
                <div class="col-lg-9">
                </div>
                <div class="col-lg-3">
                    <button id="{{path}}" class="stream" class="btn btn-success">Stream to Pi</button>
                </div>
        </div>
        
    </script>
    <script type="text/javascript">
        var ipc = require('ipc');

        ipc.on('movieInfo', function(moviePath, movieData) {
            movieData['path'] = moviePath;
            var template = $('#movieInfoTemplate').html();
            var movieInfoTemplate = Handlebars.compile(template);
            $('#movie-info').append(movieInfoTemplate(movieData));
            console.log(JSON.stringify(movieData));
        });

        $(function() {
            $(document).on('click', '.stream', function() {
                console.log('stream ' + $(this).attr('id'));
                ipc.send('stream', $(this).attr('id'));
            })
        });

    </script>

</head>
<body>
    <div style="margin:20px">
        <div id="container">
            <div class="row">
                <div class="col-lg-10">
                    <h4>Picast</h4>
                </div>
                <div class="col-lg-2">
                    <span id="pi-status" class="label label-danger pull-right">Raspberry pi not connected</span>
                </div>
            </div>
            <div id="movie-info">

            </div>
        </div>
    </div>
</body>
</html>
